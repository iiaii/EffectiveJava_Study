# #EffectiveJava/7장_람다와스트림/43메서드참조

## 43. 람다보다는 메서드 참조를 사용하라

람다가 익명 클래스보다 나은 점 중에서 가장 큰 특징은 간결함이다. 그런데 자바에는 함수 객체를 람다보다 간결하게 만드는 방법이 있는데 메서드 참조다.

```java
// 자바8에 Map에 추가된 merge 메서드
map.merge(key, 1, (count, incr) -> count + incr);
```

merge 메서드는 키, 값, 함수를 인수로 받으며 주어진 키가 맵 안에 아직 없다면 주어진 {키, 값} 쌍을 그대로 저장한다. 반대로 키가 있으면, 세번째 인수로 받은 함수를 현재 값과 주어진 값에 적용한다음 그 결과로 현재 값을 덮어 쓴다. 즉, 맵에 {키, 함수의 결과} 쌍을 저장한다.

깔끔하긴 하지만 매개변수 count와 incr은 크게 하는 일 없이 공간을 차지한다. (단순히 합을 반환함) 자바 8이 되면서 Integer 클래스(와모든 기본 타입의 박싱 타입)는 이 람다와 기능이 같은 정적 메서드 Sum을 제공하기 시작했다. 

```java
// 람다 대신 이 메서드의 참조를 전달
map.merge(key, 1, Integer::sum);
```

매개변수 수가 늘어날수록 메서드 참조로 제거할 수 있는 코드양도 늘어난다. 하지만 어떤 람다에서는 매개변수의 이름 자체가 프로그래머에게 좋은 가이드가 되기 때문에 메서드 참조보다 읽기 쉽고 유지보수도 쉬울 수 있다.

람다로 할 수 없는 일은 메서드 참조로도 할 수 없다(애매한 예외가 있기는 함, 보충설명) 그렇더라도 메서드 참조를 사용하는 편이 보통은 더 짧고 간결하므로, 람다로 구현했을 때 너무 길거나 복잡하다면 메서드 참조가 좋은 대안이 되어준다. 

```java
// 람다 vs 메서드 참조
Service.execute(GoshThisClassNameIsHumongous::action);

service.execute(() -> action());
```

위의 경우 오히려 람다 쪽이 명확하다. 예로 java.util.function 패키지가 제공하는 제네릭 정적 팩터리 메서드 Function.identity()를 사용하기 보다 (x -> x)의 람다를 직접 사용하는 게 코드도 짧고 명확하다.



##### 메서드 참조 유형
---
메서드 참조 유형	예						같은 기능을하는 람다
---
정적 				Integer::parseInt			str -> Integer.parseInt(str)
한정적 (인스턴스)	Instant.now()::isAfter		Instant then = Instant.now();
										t -> then.isAfter(t)
비한정적(인스턴스) String::toLowerCase		str -> str.toLowerCase()
클래스 생성자 		TreeMap<K,V>::new 		() -> new TreeMap<K,V>()
배열 생성자		int[]::new				len -> new int[len]
---

메서드 참조의 유형은 5가지로 가장 흔한 유형은 정적메서드를 가리키는 메서드 참조다. 나머지 4가지를 살펴보면
 먼저 인스턴스 메서드를 참조하는 유형이 2가지 있다. 그중 하나는 수신 객체(참조 대상 인스턴스)를 특정하는 한정적 인스턴스 메서드 참조이고, 다른 하나는 수신 객체를 특정하지 않는 비한정적 인스턴스 메서드 참조다.

한정적 참조는 근본적으로 정적 참조와 비슷하다. 즉, 함수 객체가 받는 인수와 참조되는 메서드가 받는 인수가 똑같다. 
비한정적 참조에서는 함수 객체를 적용하는 시점에 수신 객체를 알려준다. 이를 위해 수신 객체 전달용 매개변수가 매개변수 목록의 첫 번째로 추가되며, 매개변수 목록의 첫 번째로 추가되며 그 뒤로는 참조되는 메서드 선언에 정의된 매개변수들이 뒤 따른다. 비한정적 참조는 주로 스트림 파이프라인에서의 매핑과 필터 함수에 쓰인다.(아이템45)

클래스 생성자를 가리키는 메서드 참조와 배열 생성자를 가리키는 메서드 참조가 있다. 생성자 참조는 팩터리 객체로 사용된다. 


::핵심 정리:: 

> 메서드 참조는 람다의 간단명로한 대안이 될 수 있다. 메서드 참조 쪽이 짧고 명확하다면 메서드 참조를 쓰고, 그렇지 않을 때만 람다를 사용하라.


> 람다로는 불가능하나 메서드 참조로는 가능한 유일한 예는 제네릭함수 타입 구현이다. 

<F extends Exception> () -> String throws F

함수형 인터페이스를 위한 제네릭 함수 타입은 메서드 참조 표현식으로는 구현할 수 있지만, 람다식으로는 불가능하다. 제네릭 람다식이라는 문법이 존재하지 않기 때문


